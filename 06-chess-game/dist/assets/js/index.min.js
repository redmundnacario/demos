"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);s&&(o=o.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?ownKeys(Object(t),!0).forEach((function(s){_defineProperty(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function _defineProperty(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}var BishopMoves=function(e,s,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=e.rowNumber,a=e.colNumber,l=(e.colLetter,e.piece,range(o,i,n)),r=[1,-1],u=l.map((function(e){return[e,r[0]*e]})),p=l.map((function(e){return[e,r[1]*e]}));u=removeOutOfBoundsPossibleMoves(u,c,a,t),p=removeOutOfBoundsPossibleMoves(p,c,a,t);var g=splitPossibleMoves(u,e),h=filterPossibleMoves(g[0],s,e),v=filterPossibleMoves(g[1],s,e),d=splitPossibleMoves(p,e),m=filterPossibleMoves(d[0],s,e),b=filterPossibleMoves(d[1],s,e),f=h.possibleMoves.concat(v.possibleMoves).concat(m.possibleMoves).concat(b.possibleMoves),k=h.possibleTargets.concat(v.possibleTargets).concat(m.possibleTargets).concat(b.possibleTargets);return{possibleMoves:f,possibleTargets:k}},range=function(e,s,t){if(void 0===s&&(s=e,e=0),void 0===t&&(t=1),t>0&&e>=s||t<0&&e<=s)return[];for(var o=[],i=e;t>0?i<s:i>s;i+=t)o.push(i);return o},removeOutOfBoundsPossibleMoves=function(e,s,t,o){return e.map((function(e){var i=e[1]+s;return i<=8&i>0?o[e[0]+t-1]+i:null})).filter(Boolean)},splitPossibleMoves=function(e,s){var t=e.indexOf(s.colLetter+s.rowNumber),o=e.slice(0,t);return[o=o.reverse(),e.slice(t+1)]},filterPossibleMoves=function(e,s,t){var o=[],i=[],n=!0;return e.forEach((function(e){1==n&&(null==s[e].piece?o.push(e):s[e].piece.kingdom!=t.piece.kingdom?(i.push(e),n=!1):n=!1)})),{possibleMoves:o,possibleTargets:i}},KingMoves=function(e,s,t){var o=BishopMoves(e,s,t,-1,2),i=RookMoves(e,s,t,-1,2);return{possibleMoves:o.possibleMoves.concat(i.possibleMoves),possibleTargets:o.possibleTargets.concat(i.possibleTargets)}},CHESS_DATA={blackPawn:{location:["a7","b7","c7","d7","e7","f7","g7","h7"],htmlcode:"&#9823;",kingdom:"black",position:"pawn",img:"./assets/img/bP.png"},blackKing:{location:"e8",htmlcode:"&#9818;",kingdom:"black",position:"king",img:"./assets/img/bK.png"},blackQueen:{location:"d8",htmlcode:"&#9819;",kingdom:"black",position:"queen",img:"./assets/img/bQ.png"},blackBishop:{location:["c8","f8"],htmlcode:"&#9821;",kingdom:"black",position:"bishop",img:"./assets/img/bB.png"},blackKnight:{location:["b8","g8"],htmlcode:"&#9822;",kingdom:"black",position:"knight",img:"./assets/img/bN.png"},blackRook:{location:["a8","h8"],htmlcode:"&#9820;",kingdom:"black",position:"rook",img:"./assets/img/bR.png"},whitePawn:{location:["a2","b2","c2","d2","e2","f2","g2","h2"],htmlcode:"&#9817;",kingdom:"white",position:"pawn",img:"./assets/img/wP.png"},whiteKing:{location:"e1",htmlcode:"&#9812;",kingdom:"white",position:"king",img:"./assets/img/wK.png"},whiteQueen:{location:"d1",htmlcode:"&#9813;",kingdom:"white",position:"queen",img:"./assets/img/wQ.png"},whiteBishop:{location:["c1","f1"],htmlcode:"&#9815;",kingdom:"white",position:"bishop",img:"./assets/img/wB.png"},whiteKnight:{location:["b1","g1"],htmlcode:"&#9816;",kingdom:"white",position:"knight",img:"./assets/img/wN.png"},whiteRook:{location:["a1","h1"],htmlcode:"&#9814;",kingdom:"white",position:"rook",img:"./assets/img/wR.png"}},KnightMoves=function(e,s,t){var o=e.rowNumber,i=e.colNumber,n=(e.colLetter,e.piece),c=removeOutOfBoundsPossibleMoves([[2,1],[2,-1],[1,-2],[-1,-2],[-2,-1],[-2,1],[-1,2],[1,2]],o,i,t),a=[],l=[];return c.forEach((function(e){null==s[e].piece?a.push(e):s[e].piece.kingdom!=n.kingdom&&l.push(e)})),{possibleMoves:a,possibleTargets:l}},state={active_chess_player:"white",active_chess_box_id:null,chess_obj:[],active_chess_obj:null,pawn_double_step_status:null,letters:["a","b","c","d","e","f","g","h"],king_location:{white:null,black:null},castling:{white:{king_side:{king_move:"g1",rook_move:"f1",rook:{status:!1,location:"h1"},space_empty:{status:!1,location:["f1","g1"]},space_attacked:{status:!1,location:["f1","g1"]}},queen_side:{king_move:"c1",rook_move:"d1",rook:{status:!1,location:"a1"},space_empty:{status:!1,location:["c1","d1"]},space_attacked:{status:!1,location:["c1","d1"]}}},black:{king_side:{king_move:"g8",rook_move:"f8",rook:{status:!1,location:"h8"},space_empty:{status:!1,location:["f8","g8"]},space_attacked:{status:!1,location:["f8","g8"]}},queen_side:{king_move:"c8",rook_move:"d8",rook:{status:!1,location:"a8"},space_empty:{status:!1,location:["c8","d8"]},space_attacked:{status:!1,location:["c8","d8"]}}}},checked:{white:null,black:null},checkmate:{white:!1,black:!1},winner:null},GetPossibleMoves=function(e,s,t,o){switch(e.piece.position){case"pawn":return PawnMoves(e,s,t,o);case"knight":return KnightMoves(e,s,o);case"rook":return RookMoves(e,s,o);case"bishop":return BishopMoves(e,s,o);case"queen":return QueenMoves(e,s,o);case"king":return KingMoves(e,s,o);default:return null}},Castling=function(e,s,t){var o=t.active_chess_obj,i=t.active_chess_player;if("king"==e.piece.position&s){console.log("Castling!");var n="white"==i?"1":"8";if("g"==e.colLetter){var c="h"+n;o["f"+n].piece=o[c].piece,o[c].piece=null,setInnerImg(c,""),setInnerImg("f"+n,o["f"+n].piece.img)}else{var a="a"+n;o["d"+n].piece=o[a].piece,o[a].piece=null,setInnerImg(a,""),setInnerImg("d"+n,o["d"+n].piece.img)}}},CheckCastling=function(e){var s=e.active_chess_box_id,t=e.active_chess_player,o=e.active_chess_obj,i=e.castling,n=e.checked;if("king"==o[s].piece.position&&null!=i[t]&&(CheckIfChecked(e,null),null==n[t])){var c=i[t],a=c.king_side,l=c.queen_side;checkKingQueenSide(a,o,e),checkKingQueenSide(l,o,e)}console.log(e.castling)},checkKingQueenSide=function(e,s,t){0==e.rook.status&&(checkEmptyBoxes(e.space_empty,s),1==e.space_empty.status&&(checkIfBoxesBeingChecked(e,t),0==e.space_attacked.status&&document.getElementById(e.king_move).classList.add("castling")))},checkEmptyBoxes=function(e,s){var t=[];e.location.forEach((function(e){s[e].piece?t.push(!1):t.push(!0)})),e.status=t[0]&t[1]},checkIfBoxesBeingChecked=function(e,s){var t=s.active_chess_obj,o=s.king_location,i=s.active_chess_player,n=e.space_attacked.location,c=JSON.parse(JSON.stringify(t)),a=t[o[i]].piece;console.log(a),c[n[0]].piece=a,c[n[1]].piece=a;var l=[];n.forEach((function(e){l.push(getCheckers(e,c,s))})),l=[].concat.apply([],l),e.space_attacked.status=l.length>0},PawnMoves=function(e,s,t,o){var i=[],n=e.rowNumber,c=e.colNumber,a=e.colLetter,l=e.piece;if("white"==l.kingdom)if(2==n)for(var r=n+1;r<n+3;r++)i.push(r);else for(var u=n+1;u<n+2;u++)i.push(u);else if(7==n)for(var p=n-1;p>n-3;p--)i.push(p);else for(var g=n-1;g>n-2;g--)i.push(g);i=(i=i.filter((function(e){return e<=8}))).map((function(e){return a+e}));var h=!0;i=i.map((function(e){return null==s[e].piece&1==h?e:(h=!1,null)})).filter(Boolean);var v=[1,-1],d=[1,-1],m=[];for(var b in d)for(var f in v){var k=d[b]*v[f];m.push([v[f],k])}return{possibleMoves:i,possibleTargets:m=(m=(m=m.map((function(e){return[e[0]+c,e[1]+n]}))).map((function(e){return"white"==l.kingdom?e[1]>n?o[e[0]-1]+e[1]:null:e[1]<n?o[e[0]-1]+e[1]:null})).filter(Boolean)).map((function(e){return null!=s[e].piece?s[e].piece.kingdom==l.kingdom?null:e:t&&t.colNumber-(o.indexOf(e[0])+1)==0&&t.rowNumber-n==0?t.piece.kingdom==l.kingdom?null:e:null})).filter(Boolean)}},scanCheckers=function(e,s,t){if(e.length>0){var o=[];return e.forEach((function(e){s[e].piece.position==t&&o.push(s[e])})),o.length>0?o:null}return null},getCheckers=function(e,s,t){var o=t.pawn_double_step_status,i=t.letters,n=s[e],c=QueenMoves(n,s,i),a=RookMoves(n,s,i),l=BishopMoves(n,s,i),r=KnightMoves(n,s,i),u=KingMoves(n,s,i),p=PawnMoves(n,s,o,i),g=[scanCheckers(c.possibleTargets,s,"queen"),scanCheckers(a.possibleTargets,s,"rook"),scanCheckers(l.possibleTargets,s,"bishop"),scanCheckers(r.possibleTargets,s,"knight"),scanCheckers(u.possibleTargets,s,"king"),scanCheckers(p.possibleTargets,s,"pawn")].filter(Boolean);return g=[].concat.apply([],g)},CheckIfChecked=function(e,s){var t=e.active_chess_player,o=e.active_chess_obj,i=e.king_location;["white","black"].forEach((function(s){var t=document.getElementsByClassName("checked-"+s);Object.keys(t).forEach((function(e){t[0].classList.remove("checked-"+s)}));var n=getCheckers(i[s],o,e);if(n.length>0)e.checked[s]=n,document.getElementById(i[s]).classList.add("checked-"+s);else{e.checked[s]=null;var c=document.getElementsByClassName("checked-"+s);Object.keys(c).forEach((function(e){c[0].classList.remove("checked-"+s)}))}})),Boolean(e.checked.white)|Boolean(e.checked.black)&&console.log("Checkers!",e.checked);var n=Boolean(e.checked.white)?"white":Boolean(e.checked.black)?"black":null;null!=n&null!=s&&n!=t&&(console.log("Last move was illegal! King is being checked."),s(e))},CheckAreaIfChecked=function(e,s,t){var o=t.active_chess_player,i=t.active_chess_obj,n=t.letters;if("king"==i[e].piece.position){var c=KingMoves(i[e],i,n),a=c.possibleMoves.concat(c.possibleTargets),l=JSON.parse(JSON.stringify(i)),r={};a.forEach((function(s){l[s].piece=i[e].piece,r[s]=getCheckers(s,l,t)}));var u=[],p=[];if(Object.keys(r).forEach((function(e){r[e].length>0?p.push(e):u.push(e)})),0==u.length)t.checkmate[o]=!0,t.winner="white"==o?"black":"white",console.log("Checkmate",t.checkmate[o]),console.log("Winner",t.winner);else if(p.includes(s))return}},QueenMoves=function(e,s,t){var o=BishopMoves(e,s,t),i=RookMoves(e,s,t);return{possibleMoves:o.possibleMoves.concat(i.possibleMoves),possibleTargets:o.possibleTargets.concat(i.possibleTargets)}},EnPassant=function(e,s,t){var o=e.active_chess_obj,i=e.pawn_double_step_status;if(Boolean(i)&"pawn"==s.piece.position&&s.colNumber-i.colNumber==0&&i.rowNumber-t.rowNumber==0){var n=i.colLetter+i.rowNumber;o[n].piece=null,setInnerImg(n,""),console.log("En Passant!")}e.active_chess_obj=o},UpdateEnPassantState=function(e,s,t){"pawn"==s.piece.position&&2==Math.abs(s.rowNumber-t.rowNumber)?e.pawn_double_step_status=_objectSpread({},s):e.pawn_double_step_status=null},RookMoves=function(e,s,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:9,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=e.rowNumber,a=e.colNumber,l=(e.colLetter,e.piece,range(o,i,n)),r=l.map((function(e){return[e,0]})),u=range(o,i,n),p=u.map((function(e){return[0,e]})),g=removeOutOfBoundsPossibleMoves(r,c,a,t),h=removeOutOfBoundsPossibleMoves(p,c,a,t),v=splitPossibleMoves(g,e),d=filterPossibleMoves(v[0],s,e),m=filterPossibleMoves(v[1],s,e),b=splitPossibleMoves(h,e),f=filterPossibleMoves(b[0],s,e),k=filterPossibleMoves(b[1],s,e),_=d.possibleMoves.concat(m.possibleMoves).concat(f.possibleMoves).concat(k.possibleMoves),y=d.possibleTargets.concat(m.possibleTargets).concat(f.possibleTargets).concat(k.possibleTargets);return{possibleMoves:_,possibleTargets:y}},PawnPromotion=function(e,s,t){"pawn"==s.piece.position&&(8==s.rowNumber&"white"==t&&(s.piece={htmlcode:"&#9813;",kingdom:"white",position:"queen"},setInnerHtml(e,s.piece.htmlcode)),1==s.rowNumber&"black"==t&&(s.piece={htmlcode:"&#9819;",kingdom:"black",position:"queen"},setInnerHtml(e,s.piece.htmlcode)))},SetActivePlayer=function(e){document.getElementById("activePlayer").innerHTML=e.toUpperCase()},ToggleActivePlayer=function(e){"white"==e.active_chess_player?e.active_chess_player="black":e.active_chess_player="white",SetActivePlayer(e.active_chess_player)},getClassListIncludes=function(e,s){return document.getElementById(e).classList.value.includes(s)},setInnerHtml=function(e,s){document.getElementById(e).children[0].innerHTML=s},setInnerImg=function(e,s){document.getElementById(e).children[0].setAttribute("src",s)},DrawChessTiles=function(e){for(var s={},t=document.getElementById("app"),o=8;o>0;o--){if(o%2==0)var i=!0;else i=!1;for(var n=1;n<9;n++){if(1==i){var c="white";i=!1}else{c="black";i=!0}var a=e[n-1]+o,l=document.createElement("div");l.setAttribute("class","chess-box "+c+" "+a),l.setAttribute("id",a),t.appendChild(l),s[a]={rowNumber:o,colLetter:e[n-1],colNumber:n,piece:null}}}return s},SetChessPieces=function(e,s,t){console.log(e);var o=Object.keys(s);for(var i in o){var n=s[o[i]],c=n.location,a=n.htmlcode,l=n.kingdom,r=n.position,u=n.img;if("object"==_typeof(c))for(var p in c)e[c[p]].piece={htmlcode:a,kingdom:l,position:r,img:u};else e[c].piece={htmlcode:a,kingdom:l,position:r,img:u},"king"==r&&(t.king_location[l]=e[c].colLetter+e[c].rowNumber)}return e},DrawChessPieces=function(e){var s=Object.keys(e);for(var t in s){var o=document.getElementById(s[t]),i=document.createElement("img");i.setAttribute("class","chess-piece"),i.setAttribute("src",null!=e[s[t]].piece?e[s[t]].piece.img:""),o.appendChild(i)}},UndrawChessPieces=function(e){var s=Object.keys(e);for(var t in s){var o=document.getElementById(s[t]);o.removeChild(o.childNodes[0])}},RedrawChessPieces=function(e){var s=Object.keys(e);for(var t in s){var o=document.getElementById(s[t]),i=document.createElement("img");i.setAttribute("class","chess-piece"),i.setAttribute("src",null!=e[s[t]].piece?e[s[t]].piece.img:""),o.replaceChild(i,o.children[0])}},AddClassesOfMovesOrTargetsSquares=function(e,s){e.forEach((function(e){document.getElementById(e).classList.add("possible-move")})),s.forEach((function(e){document.getElementById(e).classList.add("possible-target")}))},RemoveClassesOfMovesOrTargetsSquares=function(){var e=document.getElementsByClassName("selected"),s=document.getElementsByClassName("possible-move"),t=document.getElementsByClassName("possible-target"),o=document.getElementsByClassName("castling");Object.keys(e).forEach((function(s){e[0].classList.remove("selected")})),Object.keys(s).forEach((function(e){s[0].classList.remove("possible-move")})),Object.keys(t).forEach((function(e){t[0].classList.remove("possible-target")})),Object.keys(o).forEach((function(e){o[0].classList.remove("castling")}))},InitializeChessMap=function(e,s){var t=e.active_chess_player,o=e.active_chess_obj,i=e.letters,n=e.chess_obj;SetActivePlayer(t);var c=DrawChessTiles(i);return n[0]=SetChessPieces(c,s,e),o=JSON.parse(JSON.stringify(n[0])),DrawChessPieces(n[0]),e.chess_obj=n,e.active_chess_obj=o,e},ReInitializeChessMap=function(e,s,t){s=JSON.parse(JSON.stringify(e)),UndrawChessPieces(s.chess_obj[0]),InitializeChessMap(s,t)},ToggleActivePiece=function(e,s){var t=s.active_chess_obj,o=s.active_chess_player,i=s.active_chess_box_id,n=s.pawn_double_step_status,c=s.letters;if(null!=t[e].piece&&t[e].piece.kingdom==o){i=e;var a=document.getElementById(e).classList;if(a.value.includes("selected"))RemoveClassesOfMovesOrTargetsSquares(),s.active_chess_box_id=i;else{RemoveClassesOfMovesOrTargetsSquares(),a.add("selected");var l=GetPossibleMoves(t[i],t,n,c),r=l.possibleMoves,u=l.possibleTargets;AddClassesOfMovesOrTargetsSquares(r,u),s.active_chess_box_id=i,CheckCastling(s)}}},PossibleMoveSelected=function(e,s){var t=s.active_chess_box_id,o=s.active_chess_player,i=s.active_chess_obj,n=s.chess_obj,c=s.castling,a=s.king_location,l=t,r=e,u=i[r],p=i[l],g=getClassListIncludes(r,"possible-move"),h=getClassListIncludes(r,"possible-target"),v=getClassListIncludes(r,"castling");if(g|h|v){if(console.log(p.piece.kingdom+" "+p.piece.position+" "+l+" to "+r),CheckAreaIfChecked(l,r,s),u.piece=p.piece,p.piece=null,setInnerImg(l,""),setInnerImg(r,u.piece.img),Castling(u,v,s),EnPassant(s,u,p),UpdateEnPassantState(s,u,p),PawnPromotion(r,u,o),n.push(JSON.parse(JSON.stringify(i))),ToggleActivePlayer(s),RemoveClassesOfMovesOrTargetsSquares(),s.chess_obj=n,"king"==u.piece.position&&(c[u.piece.kingdom]=null,a[u.piece.kingdom]=r),"rook"==u.piece.position&&null!=c[u.piece.kingdom]){var d="h"==p.colLetter?"king_side":"queen_side";console.log(p.colLetter),c[u.piece.kingdom][d].rook.status=!0}s.castling=c,s.king_location=a,CheckIfChecked(s,UndoMove)}},UndoMove=function(e){var s=e.active_chess_obj,t=e.chess_obj;e.chess_obj.length<=1||(s=JSON.parse(JSON.stringify(t[t.length-2])),t.pop(),RemoveClassesOfMovesOrTargetsSquares(),RedrawChessPieces(s),ToggleActivePlayer(e),e.active_chess_obj=s,e.chess_obj=t,findKing(e),CheckIfChecked(e,null))},findKing=function(e){var s=e.active_chess_obj;Object.keys(s).forEach((function(t){var o=s[t];o.piece&&"king"==o.piece.position&&(e.king_location[o.piece.kingdom]=o.colLetter+o.rowNumber)}))},init_state=JSON.parse(JSON.stringify(InitializeChessMap(state,CHESS_DATA))),keys=Object.keys(state.chess_obj[0]),_loop=function(e){var s=document.getElementById(keys[e]);s.addEventListener("click",(function(){ToggleActivePiece(s.id,state)})),s.addEventListener("click",(function(){PossibleMoveSelected(s.id,state)}))};for(var key in keys)_loop(key);document.getElementById("undo").addEventListener("click",(function(){UndoMove(state)}));
//# sourceMappingURL=index.min.js.map
